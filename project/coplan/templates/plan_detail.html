{% extends "base.html" %}
{% load url from future %}

{% block head_includes %}
{% endblock %}

{% block content %}

<div class="plan-description">

  <div id="id_plan-form">

    <div class="plan-overview">
      <div class="field plan-title">
	{% if not plan.id or user == plan.owner %}
	<input name="title" id="id_title" value="{{ plan.title }}" 
	       placeholder="Plan Title">
	{% else %}
	<div id="id_title">{{ plan.title }}</div>
	{% endif %}
      </div> <!-- plan-title -->

      <div class="plan-sub-overview">
	<div class="plan-owner">
	  <img class="avatar" src="http://placehold.it/40" />
	</div> <!-- plan-owner -->
	
	<div class="field plan-motivation">
	  <div class="plan-motivation-label">
	    <a href="#">{{ plan.owner.username }}</a> made this plan because:
	  </div>
	  {% if not plan.id or user == plan.owner %}
	  <textarea name="motivation" id="id_motivation" 
		    placeholder="Why this plan is important to me...">{{ plan.motivation }}</textarea>
	  {% else %}
	  <div id="id_motivation">{{ plan.motivation }}</div>
	{% endif %}
	</div> <!-- plan-motivation -->
      </div>

    </div>

    <div class="field plan-details">
      <h2>Plan Details</h2>

      {% if not plan.id or user == plan.owner %}
      <textarea name="details" id="id_details" 
		placeholder="The plan details...">{{ plan.details }}</textarea>
      {% else %}
      <div id="id_details">{{ plan.details }}</div>
      {% endif %}
    </div>

  </div>

</div>

<script>
  {% if plan_data %}
  var planData = {{ plan_data|safe }};
  {% else %}
  var planData = {owner: {{ user.pk|default:"1" }} };
  {% endif %}

  var Coplan = Coplan || {};
  Coplan.planUrlRoot = '{% url "plan_list" %}';
</script>

<script src="{{ STATIC_URL }}coplan/js/models.js"></script>
<script src="{{ STATIC_URL }}coplan/js/views.js"></script>

<script>
  var plan = new Coplan.Plan(planData);
  var planView = new Coplan.PlanView({model: plan});
</script>

{% endblock %}

